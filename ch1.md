# 1장. 신뢰할 수 있고 확장 가능하며 유지보수하기 쉬운 애플리케이션
- 오늘날 많은 애플리케이션은 **계산 중심**보다는 **데이터 중심**
- 데이터 중심 애플리케이션은 다음을 필요로 함
    - 데이터베이스: 애플리케이션에서 나중에 데이터를 다시 찾을수 있게 데이터 저장
    - 캐시: 읽기 속도 향상을 위해 값비싼 수행 결과를 IO가 빠른 기억 장치에 저장
    - 검색 색인: 키워드로 데이터 검색하거나 검색 필터링
    - 스트림 처리: 비동기 처리를 위해 다른 프로세스로 메시지 보내기
    - 일괄 처리: 주기적으로 대량의 누적 데이터 분석
- 데이터 시스템의 성공적인 추상화 덕에 표준 구성요소로 데이터 애플리케이션 만듬
    - 엔지니어 입장에서 데이터 시스템 설계 용이
    - 그러나 현실에서는 애플리케이션마다 요구사항 다름
- 데이터 시스템의 원칙과 실용성
# 데이터 시스템
- DB, 큐, 캐시 등은 다른 범주에 속하는 도구
- 이러한 도구들을 묶어 데이터 시스템이라고 함
- 최근의 도구들은 다양한 사용 사례에 최적화되어 분류 간 경계가 흐려지고 있음
    - 메시지 큐의 경우 데이터스토어로 사용하는 Redis가 있는 반면 지속성을 보장하는 Apache Kafka도 있음
- 단일 도구로는 데이터 처리와 저장 모두 만족 불가능할 정도로 광범위한 요구사항 존재
    - work를 단일 도구에서 효율적으로 수행할 수 있는 task로 나누고 각 task를 수행할 수 있는 도구들은 애플리케이션 코드를 이용해 서로 연결
- 애플리케이션 개발자는 데이터 시스템 설계자이기도 함
# 신뢰성
- HW/SW 결함이나 human error에도 시스템이 지속적으로 올바르게 동작해야함
- 소프트웨어에 대한 일반적인 기대치는 다음과 같음
    - 애플리케이션은 사용자가 기대한 기능 수행 - Functionality
    - 시스템은 사용자가 범한 실수나 예상치 못한 사용법을 허용 할 수 있음 - Exception Handling
    - 시스템 성능은 예상된 부하와 데이터 양에서 필수적인 사용 사례를 충분히 만족 - Throughput
    - 시스템은 허가되지 않은 접근과 오남용을 방지 - Security
- 무언가 잘못되더라도 위 기대치가 만족되는것이 신뢰성이라고 볼 수도 있음
## 결함
- 결함이란 잘못될 수 있는 일
- 결함을 예측/대처할 수 있는 시스템은 fault-tolerant 혹은 resilient
- 결함 ≠ 장애
    - 결함은 시스템의 한 구성 요소
    - 장애는 사용자에게 필요한 서비스를 제공 못하고 시스템 전체가 멈춘 경우
    - 따라서 장애란 결함으로 인한 결과
- fault-toleerant한 구조를 설계하여 **신뢰할 수 없는 여러 부품으로 신뢰할 수 있는 시스템 구축**
- 경고 없이 프로세스를 무작위로 죽여 고의적으로 결함을 일으켜 결함률을 증가시키는 방법은 생각보다 납득 가능
    - 미흡한 오류처리보다 고의적인 결함 유도를 통해 자연적인 결함 발생 때 올바르게 처리할 수 있게 하기 위해 시스템에 대해 지속적인 훈련 및 테스트
    - 넷플릭스 - 카오스 몽키
- 예방책이 해결책보다 더 좋은 경우 존재
    - 보안 문제의 경우 공격자가 시스템을 손상시켜 민감한 데이터에 대한 접근 권한을 언든다면 이를 되돌릴 수 없음
### 하드웨어 결함
- 규모가 큰 데이터센터에서는 늘상 일어나는 일
- 구성 요소에 중복을 추가하여 하드웨어 결함으로 인한 시스템 장애율 줄임
    - RAID 디스크
        - 저렴한/독립적인 여러 디스크를 엮어 하나의 디스크처럼 사용하는 방법
    - 이중 전원 디바이스
    - hot-swap 가능한 CPU
    - 예비 전원용 발전기
- 단일 장비의 전체 장애가 드물었을 때는 HW 구성요쇼 중복으로 충분했음
    - 장비 백업으로 인한 중단시간은 치명적이지 않음
    - HA가 필수적인 소수의 경우에만 다중 장비 중복 필요
- 데이터 양과 계산 요구가 늘어나면서 더 많은 수의 장비를 사용하고 이에 따라 HW 결함율 증가
    - AWS의 경우 장비 인스턴스 별도 경고 없이 사용 못하는 상황이 일반적으로 발생
    - 이런 플랫폼은 단일 장비 신뢰성보다 유연성, 탄력성 우선적으로 설계
- 일반적으로 하드웨어 결함은 독립적이거나 약한 상관관계
    - 다수의 구성 요소에 동시 장애 발생x
### 소프트웨어 오류
- 시스템 내 체계적 오류(systemiatic error)
    - 노드 간 상관관계 때문에 HW 결함보다 시스템 오류를 더 많이 유발
    - 특정 입력이 있을 때 모든 어플리케이션 서버 인스턴스가 죽는 경우
    - 공유 자원을 과도하게 사용하는 일부 프로세스
    - 시스템 속도가 느려져 반응이 없거나 잘못된 응답 반환하는 서비스
    - 한 구성 요소의 작은 결함이 다른 구성 요소의 결함을 야기하여 더 많은 결함이 발생하는 연쇄 장애(cascading failure)
- 소프트웨어 결함을 유발하는 버그는 특정 상황에 의해 발생하기 전까지 오랫동안 나타나지 않음
    - 시스템 가정과 상호작용에 대한 주의깊은 생각
    - 빈틈없는 테스트
    - 프로세스 격리(process isolation)
    - 죽은 프로세스 재시작 허용
    - 프로덕션 환경에서 시스템 동작 측정, 모니터링, 분석
### 인적 오류
- 운영자 설정 오류가 중단의 주요 원인
- 추상화, API, 관리 인터페이스 사용하여 오류 가능성 최소화
    - 그러나 인터페이스가 지나치게 제한적이면 제한된 인터페이스를 피해 작업, 균형 맞추기 어려움
- 실제 데이터를 사용해 안전하게 실험할 수 있으면서 실 사용자에게 영향 없는 비 프로덕션 sandbox 제공
- 철저한 테스트
- 인적 오류 빠르고 쉽게 복구할 수 있게 하라
    - 롤백, 롤아웃, 데이터 재계산 도구
- 모니터링 댗책
- 조작 교육 및 실습
### 신뢰성은 얼마나 중요할까?
신뢰성은 일상적인 애플리케이션에서도 매우 중요, 사용자에 대한 책임
## 확장성
